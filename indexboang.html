<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Oral Cancer Prediction</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

  <div class="container py-5">
    <h1 class="text-center mb-4">Oral Cancer Prediction</h1>

    <div class="card shadow p-4">
      <form id="predictionForm">
        <div class="row mb-3">
          <div class="col">
            <label for="age" class="form-label">Age</label>
            <input type="number" class="form-control" id="age" required>
          </div>
          <div class="col">
            <label for="tumorSize" class="form-label">Tumor Size (cm)</label>
            <input type="number" step="0.1" class="form-control" id="tumorSize" required>
          </div>
        </div>

        <!-- Demographics & Lifestyle -->
        <div class="row mb-3">
          <div class="col">
            <label for="gender" class="form-label">Gender</label>
            <select class="form-select" id="gender" required>
              <option value="">Select</option>
              <option value="Male">Male</option>
              <option value="Female">Female</option>
            </select>
          </div>
        </div>

        <!-- Risk Factors -->
        <div class="row mb-3">
          <div class="col">
            <label for="tobaccoUse" class="form-label">Tobacco Use</label>
            <select class="form-select" id="tobaccoUse">
              <option value="No">No</option>
              <option value="Yes">Yes</option>
            </select>
          </div>
          <div class="col">
            <label for="alcoholConsumption" class="form-label">Alcohol Consumption</label>
            <select class="form-select" id="alcoholConsumption">
              <option value="No">No</option>
              <option value="Yes">Yes</option>
            </select>
          </div>
          <div class="col">
            <label for="hpvInfection" class="form-label">HPV Infection</label>
            <select class="form-select" id="hpvInfection">
              <option value="No">No</option>
              <option value="Yes">Yes</option>
            </select>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col">
            <label for="betelQuidUse" class="form-label">Betel Quid Use</label>
            <select class="form-select" id="betelQuidUse">
              <option value="No">No</option>
              <option value="Yes">Yes</option>
            </select>
          </div>
          <div class="col">
            <label for="sunExposure" class="form-label">Chronic Sun Exposure</label>
            <select class="form-select" id="sunExposure">
              <option value="No">No</option>
              <option value="Yes">Yes</option>
            </select>
          </div>
          <div class="col">
            <label for="oralHygiene" class="form-label">Poor Oral Hygiene</label>
            <select class="form-select" id="oralHygiene">
              <option value="No">No</option>
              <option value="Yes">Yes</option>
            </select>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col">
            <label for="diet" class="form-label">Diet (Fruits & Vegetables Intake)</label>
            <select class="form-select" id="diet">
              <option value="Low">Low</option>
              <option value="Moderate">Moderate</option>
              <option value="High">High</option>
            </select>
          </div>
          <div class="col">
            <label for="familyHistory" class="form-label">Family History of Cancer</label>
            <select class="form-select" id="familyHistory">
              <option value="No">No</option>
              <option value="Yes">Yes</option>
            </select>
          </div>
          <div class="col">
            <label for="immuneSystem" class="form-label">Compromised Immune System</label>
            <select class="form-select" id="immuneSystem">
              <option value="No">No</option>
              <option value="Yes">Yes</option>
            </select>
          </div>
        </div>

        <!-- Symptoms -->
        <div class="row mb-3">
          <div class="col">
            <label for="oralLesions" class="form-label">Oral Lesions</label>
            <select class="form-select" id="oralLesions">
              <option value="No">No</option>
              <option value="Yes">Yes</option>
            </select>
          </div>
          <div class="col">
            <label for="bleeding" class="form-label">Unexplained Bleeding</label>
            <select class="form-select" id="bleeding">
              <option value="No">No</option>
              <option value="Yes">Yes</option>
            </select>
          </div>
          <div class="col">
            <label for="swallowing" class="form-label">Difficulty Swallowing</label>
            <select class="form-select" id="swallowing">
              <option value="No">No</option>
              <option value="Yes">Yes</option>
            </select>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col">
            <label for="patches" class="form-label">White/Red Patches in Mouth</label>
            <select class="form-select" id="patches">
              <option value="No">No</option>
              <option value="Yes">Yes</option>
            </select>
          </div>
          <div class="col">
            <label for="treatmentType" class="form-label">Treatment Type</label>
            <select class="form-select" id="treatmentType">
              <option value="Surgery">Surgery</option>
              <option value="Radiation">Radiation</option>
              <option value="Chemotherapy">Chemotherapy</option>
              <option value="Immunotherapy">Immunotherapy</option>
            </select>
          </div>
          <div class="col">
            <label for="earlyDiagnosis" class="form-label">Early Diagnosis</label>
            <select class="form-select" id="earlyDiagnosis">
              <option value="No">No</option>
              <option value="Yes">Yes</option>
            </select>
          </div>
        </div>

        <div class="text-center">
          <button type="submit" class="btn btn-primary mt-3">Predict</button>
        </div>
      </form>
    </div>

    <div id="result" class="mt-4 text-center"></div>
  </div>

  <script>

       document.getElementById('predictionForm').addEventListener('submit', async function (e) {
      e.preventDefault();

      const inputData = {
        "Age": parseFloat(document.getElementById('age').value),
        "Tumor Size (cm)": parseFloat(document.getElementById('tumorSize').value),
        "Cost of Treatment (USD)": 0,
        "Economic Burden (Lost Workdays per Year)": 0,
        "Country": "Philippines",
        "Gender": document.getElementById('gender').value,
        "Tobacco Use": "Yes",
        "Alcohol Consumption": "No",
        "HPV Infection": "No",
        "Betel Quid Use": "No",
        "Chronic Sun Exposure": "No",
        "Poor Oral Hygiene": "Yes",
        "Diet (Fruits & Vegetables Intake)": "Low",
        "Family History of Cancer": "No",
        "Compromised Immune System": "No",
        "Oral Lesions": "Yes",
        "Unexplained Bleeding": "No",
        "Difficulty Swallowing": "No",
        "White or Red Patches in Mouth": "Yes",
        "Treatment Type": "Surgery",
        "Early Diagnosis": "Yes"
      };

      const requestData = { inputs: [inputData] };

      try {
        const response = await fetch('https://test-gwapo-flask.onrender.com/predict', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(requestData)
        });

        const result = await response.json();
        console.log("Response:", result);

        if (!response.ok || !result.prediction_probabilities) {
          throw new Error(result.error || 'Invalid response from server.');
        }

        const probs = result.prediction_probabilities;
        const predictedClass = probs[1] > probs[0] ? "Yes" : "No";

        const riskDetails = `0: ${(probs[0] * 100).toFixed(2)}%\n1: ${(probs[1] * 100).toFixed(2)}%`;

        const fullResult = `
          <h4 class="alert-heading">Prediction Result</h4>
          <p><strong>Prediction:</strong> ${predictedClass}</p>
          <pre><strong>Risk Breakdown:</strong>\n${riskDetails}</pre>
        `;

        document.getElementById('result').innerHTML = `
          <div class="alert alert-info text-start" role="alert">
            ${fullResult}
          </div>
        `;
      } catch (error) {
        console.error('Error:', error);
        document.getElementById('result').innerHTML = `
          <div class="alert alert-danger" role="alert">
            An error occurred: ${error.message}
          </div>
        `;
      }
    });

  </script>
</body>
</html>
